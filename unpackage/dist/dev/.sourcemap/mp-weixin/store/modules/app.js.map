{"version":3,"file":"app.js","sources":["store/modules/app.ts"],"sourcesContent":["import { defineStore } from 'pinia'\nimport { ref } from 'vue'\n\nexport const useAppStore = defineStore('app', () => {\n\n    const role = ref(0)\n    const isLogin = ref(false)\n    const userId = ref('')\n    const token = ref('')\n\n    // 设置登录信息\n    const setLoginInfo = (info: any, tokenStr: string) => {\n        isLogin.value = true\n        userId.value = info._id || info.uid || ''\n        role.value = info.role || 0  // 0-普通用户, 1-管理员\n        token.value = tokenStr\n        \n        // 保存到本地存储\n        uni.setStorageSync('uni_id_token', tokenStr)\n        uni.setStorageSync('userId', userId.value)\n        uni.setStorageSync('role', role.value)\n    }\n\n    // 清除登录信息\n    const clearLoginInfo = () => {\n        isLogin.value = false\n        userId.value = ''\n        role.value = 0\n        token.value = ''\n        \n        // 清除本地存储\n        uni.removeStorageSync('uni_id_token')\n        uni.removeStorageSync('userId')\n        uni.removeStorageSync('role')\n    }\n\n    // 从本地存储恢复登录状态\n    const restoreLoginState = () => {\n        const savedToken = uni.getStorageSync('uni_id_token')\n        const savedUserId = uni.getStorageSync('userId')\n        const savedRole = uni.getStorageSync('role')\n        \n        if (savedToken && savedUserId) {\n            isLogin.value = true\n            token.value = savedToken\n            userId.value = savedUserId\n            role.value = savedRole || 0\n        }\n    }\n\n    return {\n        role,\n        isLogin,\n        userId,\n        token,\n        setLoginInfo,\n        clearLoginInfo,\n        restoreLoginState\n    }\n})"],"names":["defineStore","ref","uni"],"mappings":";;AAGa,MAAA,cAAcA,cAAAA,YAAY,OAAO,MAAM;AAE1C,QAAA,OAAOC,kBAAI,CAAC;AACZ,QAAA,UAAUA,kBAAI,KAAK;AACnB,QAAA,SAASA,kBAAI,EAAE;AACf,QAAA,QAAQA,kBAAI,EAAE;AAGd,QAAA,eAAe,CAAC,MAAW,aAAqB;AAClD,YAAQ,QAAQ;AAChB,WAAO,QAAQ,KAAK,OAAO,KAAK,OAAO;AAClC,SAAA,QAAQ,KAAK,QAAQ;AAC1B,UAAM,QAAQ;AAGVC,kBAAAA,MAAA,eAAe,gBAAgB,QAAQ;AACvCA,kBAAAA,MAAA,eAAe,UAAU,OAAO,KAAK;AACrCA,kBAAAA,MAAA,eAAe,QAAQ,KAAK,KAAK;AAAA,EAAA;AAIzC,QAAM,iBAAiB,MAAM;AACzB,YAAQ,QAAQ;AAChB,WAAO,QAAQ;AACf,SAAK,QAAQ;AACb,UAAM,QAAQ;AAGdA,wBAAI,kBAAkB,cAAc;AACpCA,wBAAI,kBAAkB,QAAQ;AAC9BA,wBAAI,kBAAkB,MAAM;AAAA,EAAA;AAIhC,QAAM,oBAAoB,MAAM;AACtB,UAAA,aAAaA,cAAAA,MAAI,eAAe,cAAc;AAC9C,UAAA,cAAcA,cAAAA,MAAI,eAAe,QAAQ;AACzC,UAAA,YAAYA,cAAAA,MAAI,eAAe,MAAM;AAE3C,QAAI,cAAc,aAAa;AAC3B,cAAQ,QAAQ;AAChB,YAAM,QAAQ;AACd,aAAO,QAAQ;AACf,WAAK,QAAQ,aAAa;AAAA,IAC9B;AAAA,EAAA;AAGG,SAAA;AAAA,IACH;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EAAA;AAER,CAAC;;"}